
# 小商店经营模拟器 - README 文档

## 一、项目简介

「小商店经营模拟器」是一款基于 Bash Shell 开发的文本交互类经营游戏，玩家通过进货、调整售价、应对每日市场波动等操作，实现商店盈利目标。游戏新增**市场浮动价**（可能亏损）、**阶梯税率**（盈利越高缴税越多）、**商品解锁**（资金达标解锁新商品）、**成就系统**（限时营收目标）、**历史记录系统**（自动保存最近 20 次游玩数据，支持查询）五大核心玩法，兼顾策略性与趣味性。

## 二、文件结构


```plaintext
shop_simulator/          # 游戏根目录
├── main.sh              # 主入口文件（负责模块加载、游戏流程控制）
├── lib/                 # 通用工具库目录
│   └── utils.sh         # 工具函数（分转元、输入验证、价格格式校验）
└── modules/             # 核心业务模块目录
    ├── init.sh          # 游戏初始化（初始资金、库存、成就目标配置）
    ├── status.sh        # 状态显示（每日资金、库存、解锁商品展示）
    ├── buy_stock.sh     # 进货功能（选择商品、输入数量、扣减资金）
    ├── adjust_price.sh  # 售价调整（修改商品售价，确保高于成本价）
    ├── market_price.sh  # 市场价格生成（每日为商品生成浮动市场价，±30%）
    ├── unlock_product.sh# 商品解锁（资金达标时自动解锁新商品并加入库存）
    ├── business.sh      # 营业逻辑（销售计算、随机事件、阶梯税款扣除）
    └── game_over.sh     # 结束处理（检查亏损/成就条件、显示经营总结）
```

## 三、运行环境

- **系统要求**：Linux/macOS（支持 Bash Shell 的环境，Windows 需通过 WSL、Git Bash 等工具运行）
- **依赖**：无额外软件依赖（原生 Bash 即可运行）

## 四、执行步骤

### 1. 下载 / 解压项目

将项目文件按上述结构放置在本地目录（如`/home/yourname/shop_simulator/`）。

### 2. 赋予文件执行权限

打开终端，进入游戏根目录，执行以下命令为所有脚本文件添加可执行权限：


```bash
cd shop_simulator  # 进入游戏根目录
chmod +x main.sh lib/*.sh modules/*.sh  # 赋予所有脚本执行权限
```

### 3. 启动游戏

在游戏根目录执行主入口文件：

```bash
./main.sh
```

## 五、游戏核心玩法

### 1. 基础操作流程

1. **启动游戏**：执行`./main.sh`后，查看新功能提示，按回车键开始；
2. **每日操作选择**：
    - `1. 进货`：选择商品编号和数量，扣减资金并增加库存；
    - `2. 调整售价`：修改商品售价（需高于成本价，参考当日市场价）；
    - `3. 开始今日营业`：自动生成市场价→处理随机事件→计算销量与利润→扣除税款 / 房租；
    - `4. 退出游戏`：确认后退出，显示经营总结；
    - `5. 查看历史记录`：展示最近 20 次游玩的关键数据（日期、经营天数、最终资金等）；
3. **游戏结束**：达成成就（如 10 天营收≥500 元）、连续 3 天亏损、资金不足支付房租或 20 天未达标时，游戏自动结束。

### 2. 关键机制说明

|机制|规则详情|
|---|---|
|市场浮动价|每日营业前生成，基于商品成本价 ±30% 随机浮动；  <br>售价＞市场价：销量 ×0.5；  <br>售价 = 市场价：销量正常；  <br>售价＜市场价：销量 ×1.5；  <br>市场价＜成本价：销售会亏损。|
|阶梯税率|当日税前利润≤50 元：免税；  <br>50 元＜利润≤100 元：10% 税率；  <br>100 元＜利润≤200 元：20% 税率；  <br>利润＞200 元：30% 税率。|
|商品解锁|资金达 150 元：解锁「橙子」；  <br>资金达 250 元：解锁「饮料」；  <br>资金达 350 元：解锁「大米」；  <br>资金达 500 元：解锁「牛肉」。|
|成就系统|基础成就：10 天内营收≥500 元（经营合格）；  <br>进阶成就：15 天内营收≥1000 元（经营达人）；  <br>终极成就：20 天内营收≥2000 元（商业大亨）。|

## 六、常见问题

### 1. 执行`./main.sh`提示 “Permission denied”

- 原因：未赋予脚本执行权限；
- 解决：执行`chmod +x main.sh lib/*.sh modules/*.sh`后重试。

### 2. 终端显示乱码（如红色提示不显示）

- 原因：终端不支持 ANSI 颜色代码；
- 解决：更换支持 ANSI 颜色的终端（如 Linux 原生终端、iTerm2、Git Bash）。

### 3. 游戏中途退出后，进度是否保存？

- 目前版本为 “单次游玩” 模式，退出后进度不保存，重新启动游戏将从第 1 天开始。

## 七、版本说明

- **当前版本**：v2.1（新增历史记录系统，支持自动保存、查询最近 20 次游玩数据）

- **历史版本**：v2.0（新增市场浮动价、阶梯税率、商品解锁、成就系统）

- **历史版本**：v1.0（基础经营功能，无风险与目标机制）

